\doxysection{Dynamic\+Encryption.\+cs}
\hypertarget{_dynamic_encryption_8cs_source}{}\label{_dynamic_encryption_8cs_source}\index{DynamicEncryption.cs@{DynamicEncryption.cs}}
\mbox{\hyperlink{_dynamic_encryption_8cs}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{_dynamic_encryption_8cs_source_l00001}00001\ \textcolor{keyword}{using\ }\mbox{\hyperlink{namespace_s_a_p_team_1_1_kryptor_1_1_extensions}{SAPTeam.Kryptor.Extensions}};}
\DoxyCodeLine{\Hypertarget{_dynamic_encryption_8cs_source_l00002}00002\ \textcolor{keyword}{using\ }\mbox{\hyperlink{namespace_s_a_p_team_1_1_kryptor_1_1_helpers}{SAPTeam.Kryptor.Helpers}};}
\DoxyCodeLine{\Hypertarget{_dynamic_encryption_8cs_source_l00003}00003\ }
\DoxyCodeLine{\Hypertarget{_dynamic_encryption_8cs_source_l00004}\mbox{\hyperlink{namespace_s_a_p_team_1_1_kryptor_1_1_crypto_providers}{00004}}\ \textcolor{keyword}{namespace\ }\mbox{\hyperlink{namespace_s_a_p_team_1_1_kryptor_1_1_crypto_providers}{SAPTeam.Kryptor.CryptoProviders}}}
\DoxyCodeLine{\Hypertarget{_dynamic_encryption_8cs_source_l00005}00005\ \{}
\DoxyCodeLine{\Hypertarget{_dynamic_encryption_8cs_source_l00010}\mbox{\hyperlink{class_s_a_p_team_1_1_kryptor_1_1_crypto_providers_1_1_dynamic_encryption}{00010}}\ \ \ \ \ \textcolor{keyword}{public}\ \textcolor{keyword}{sealed}\ \textcolor{keyword}{class\ }\mbox{\hyperlink{class_s_a_p_team_1_1_kryptor_1_1_crypto_providers_1_1_dynamic_encryption}{DynamicEncryption}}\ :\ \mbox{\hyperlink{class_s_a_p_team_1_1_kryptor_1_1_crypto_provider}{CryptoProvider}}}
\DoxyCodeLine{\Hypertarget{_dynamic_encryption_8cs_source_l00011}00011\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{_dynamic_encryption_8cs_source_l00015}\mbox{\hyperlink{class_s_a_p_team_1_1_kryptor_1_1_crypto_providers_1_1_dynamic_encryption_a2874ca2c4dbacacb5754ab0f471415db}{00015}}\ \ \ \ \ \ \ \ \ \textcolor{keyword}{public}\ \mbox{\hyperlink{class_s_a_p_team_1_1_kryptor_1_1_crypto_providers_1_1_dynamic_encryption_a2874ca2c4dbacacb5754ab0f471415db}{DynamicEncryption}}()}
\DoxyCodeLine{\Hypertarget{_dynamic_encryption_8cs_source_l00016}00016\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{_dynamic_encryption_8cs_source_l00017}00017\ }
\DoxyCodeLine{\Hypertarget{_dynamic_encryption_8cs_source_l00018}00018\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{_dynamic_encryption_8cs_source_l00019}00019\ }
\DoxyCodeLine{\Hypertarget{_dynamic_encryption_8cs_source_l00029}\mbox{\hyperlink{class_s_a_p_team_1_1_kryptor_1_1_crypto_providers_1_1_dynamic_encryption_a85d3b9251e8c183b777158c3e57bf383}{00029}}\ \ \ \ \ \ \ \ \ \textcolor{keyword}{public}\ \mbox{\hyperlink{class_s_a_p_team_1_1_kryptor_1_1_crypto_providers_1_1_dynamic_encryption_a85d3b9251e8c183b777158c3e57bf383}{DynamicEncryption}}(\mbox{\hyperlink{struct_s_a_p_team_1_1_kryptor_1_1_key_store}{KeyStore}}\ keyStore,\ \mbox{\hyperlink{class_s_a_p_team_1_1_kryptor_1_1_crypto_provider_configuration}{CryptoProviderConfiguration}}\ configuration\ =\ \textcolor{keyword}{null})\ =>\ \mbox{\hyperlink{class_s_a_p_team_1_1_kryptor_1_1_crypto_provider_acc57d90780c392e32d2f2c6c247df642}{ApplyHeader}}(keyStore,\ configuration);}
\DoxyCodeLine{\Hypertarget{_dynamic_encryption_8cs_source_l00030}00030\ }
\DoxyCodeLine{\Hypertarget{_dynamic_encryption_8cs_source_l00032}\mbox{\hyperlink{class_s_a_p_team_1_1_kryptor_1_1_crypto_providers_1_1_dynamic_encryption_abc7d94301224556c2d369b89f7c88c5b}{00032}}\ \ \ \ \ \ \ \ \ \textcolor{keyword}{public}\ \textcolor{keyword}{override}\ async\ Task<byte[]>\ \mbox{\hyperlink{class_s_a_p_team_1_1_kryptor_1_1_crypto_providers_1_1_dynamic_encryption_abc7d94301224556c2d369b89f7c88c5b}{EncryptBlockAsync}}(\textcolor{keywordtype}{byte}[]\ data,\ \mbox{\hyperlink{struct_s_a_p_team_1_1_kryptor_1_1_crypto_process}{CryptoProcess}}\ process,\ CancellationToken\ cancellationToken)}
\DoxyCodeLine{\Hypertarget{_dynamic_encryption_8cs_source_l00033}00033\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{_dynamic_encryption_8cs_source_l00034}00034\ \ \ \ \ \ \ \ \ \ \ \ \ process.\mbox{\hyperlink{struct_s_a_p_team_1_1_kryptor_1_1_crypto_process_a79ae3d2618fcb6694b47fbcf31221f5d}{ProcessData}}[\$\textcolor{stringliteral}{"{}b\{process.BlockIndex\}.sha512"{}}]\ =\ data.Sha512();}
\DoxyCodeLine{\Hypertarget{_dynamic_encryption_8cs_source_l00035}00035\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ await\ base.EncryptBlockAsync(data,\ process,\ cancellationToken);}
\DoxyCodeLine{\Hypertarget{_dynamic_encryption_8cs_source_l00036}00036\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{_dynamic_encryption_8cs_source_l00037}00037\ }
\DoxyCodeLine{\Hypertarget{_dynamic_encryption_8cs_source_l00039}\mbox{\hyperlink{class_s_a_p_team_1_1_kryptor_1_1_crypto_providers_1_1_dynamic_encryption_acfc959522dfbb23c159f7ed162c36088}{00039}}\ \ \ \ \ \ \ \ \ \textcolor{keyword}{public}\ \textcolor{keyword}{override}\ async\ Task<byte[]>\ \mbox{\hyperlink{class_s_a_p_team_1_1_kryptor_1_1_crypto_providers_1_1_dynamic_encryption_acfc959522dfbb23c159f7ed162c36088}{DecryptBlockAsync}}(\textcolor{keywordtype}{byte}[]\ data,\ \mbox{\hyperlink{struct_s_a_p_team_1_1_kryptor_1_1_crypto_process}{CryptoProcess}}\ process,\ CancellationToken\ cancellationToken)}
\DoxyCodeLine{\Hypertarget{_dynamic_encryption_8cs_source_l00040}00040\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{_dynamic_encryption_8cs_source_l00041}00041\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{byte}[]\ decData\ =\ await\ base.DecryptBlockAsync(data,\ process,\ cancellationToken);}
\DoxyCodeLine{\Hypertarget{_dynamic_encryption_8cs_source_l00042}00042\ \ \ \ \ \ \ \ \ \ \ \ \ process.\mbox{\hyperlink{struct_s_a_p_team_1_1_kryptor_1_1_crypto_process_a79ae3d2618fcb6694b47fbcf31221f5d}{ProcessData}}[\$\textcolor{stringliteral}{"{}b\{process.BlockIndex\}.sha512"{}}]\ =\ decData.Sha512();}
\DoxyCodeLine{\Hypertarget{_dynamic_encryption_8cs_source_l00043}00043\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ decData;}
\DoxyCodeLine{\Hypertarget{_dynamic_encryption_8cs_source_l00044}00044\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{_dynamic_encryption_8cs_source_l00045}00045\ }
\DoxyCodeLine{\Hypertarget{_dynamic_encryption_8cs_source_l00047}\mbox{\hyperlink{class_s_a_p_team_1_1_kryptor_1_1_crypto_providers_1_1_dynamic_encryption_a59408f95898601928cc4b015f00772f0}{00047}}\ \ \ \ \ \ \ \ \ \textcolor{keyword}{protected}\ \textcolor{keyword}{override}\ async\ Task<IEnumerable<byte>>\ \mbox{\hyperlink{class_s_a_p_team_1_1_kryptor_1_1_crypto_providers_1_1_dynamic_encryption_a59408f95898601928cc4b015f00772f0}{EncryptChunkAsync}}(\textcolor{keywordtype}{byte}[]\ chunk,\ \mbox{\hyperlink{struct_s_a_p_team_1_1_kryptor_1_1_crypto_process}{CryptoProcess}}\ process,\ CancellationToken\ cancellationToken)\ =>\ await\ AesHelper.EncryptAesCbcAsync(chunk,\ CreateDynamicKey(process),\ CreateMixedIV(\mbox{\hyperlink{struct_s_a_p_team_1_1_kryptor_1_1_key_store}{KeyStore}},\ process),\ cancellationToken);}
\DoxyCodeLine{\Hypertarget{_dynamic_encryption_8cs_source_l00048}00048\ }
\DoxyCodeLine{\Hypertarget{_dynamic_encryption_8cs_source_l00050}\mbox{\hyperlink{class_s_a_p_team_1_1_kryptor_1_1_crypto_providers_1_1_dynamic_encryption_a4b870f27b37ee2b71ac07e3b99d278b8}{00050}}\ \ \ \ \ \ \ \ \ \textcolor{keyword}{protected}\ \textcolor{keyword}{override}\ async\ Task<IEnumerable<byte>>\ \mbox{\hyperlink{class_s_a_p_team_1_1_kryptor_1_1_crypto_providers_1_1_dynamic_encryption_a4b870f27b37ee2b71ac07e3b99d278b8}{DecryptChunkAsync}}(\textcolor{keywordtype}{byte}[]\ cipher,\ \mbox{\hyperlink{struct_s_a_p_team_1_1_kryptor_1_1_crypto_process}{CryptoProcess}}\ process,\ CancellationToken\ cancellationToken)\ =>\ await\ AesHelper.DecryptAesCbcAsync(cipher,\ CreateDynamicKey(process),\ CreateMixedIV(\mbox{\hyperlink{struct_s_a_p_team_1_1_kryptor_1_1_key_store}{KeyStore}},\ process),\ cancellationToken);}
\DoxyCodeLine{\Hypertarget{_dynamic_encryption_8cs_source_l00051}00051\ }
\DoxyCodeLine{\Hypertarget{_dynamic_encryption_8cs_source_l00052}00052\ \ \ \ \ \ \ \ \ \textcolor{keyword}{private}\ \textcolor{keywordtype}{byte}[]\ CreateDynamicKey(\mbox{\hyperlink{struct_s_a_p_team_1_1_kryptor_1_1_crypto_process}{CryptoProcess}}\ process)}
\DoxyCodeLine{\Hypertarget{_dynamic_encryption_8cs_source_l00053}00053\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{_dynamic_encryption_8cs_source_l00054}00054\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{byte}[]\ key1\ =\ \mbox{\hyperlink{struct_s_a_p_team_1_1_kryptor_1_1_key_store}{KeyStore}}[Configuration.Continuous\ ?\ (process.ChunkIndex\ +\ process.\mbox{\hyperlink{struct_s_a_p_team_1_1_kryptor_1_1_crypto_process_a1497fa24adbf3278698a14ab1ecd33df}{BlockIndex}})\ *\ 7\ :\ (process.ChunkIndex\ -\/\ process.\mbox{\hyperlink{struct_s_a_p_team_1_1_kryptor_1_1_crypto_process_a1497fa24adbf3278698a14ab1ecd33df}{BlockIndex}})\ *\ 3];}
\DoxyCodeLine{\Hypertarget{_dynamic_encryption_8cs_source_l00055}00055\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{byte}[]\ key2\ =\ \mbox{\hyperlink{struct_s_a_p_team_1_1_kryptor_1_1_key_store}{KeyStore}}[process.ChunkIndex\ -\/\ (Configuration.RemoveHash\ ?\ key1[4]\ :\ process.\mbox{\hyperlink{struct_s_a_p_team_1_1_kryptor_1_1_crypto_process_a2adefff6d95c1aa4dca2a880a1403e49}{BlockHash}}[key1[27]\ \%\ 32])];}
\DoxyCodeLine{\Hypertarget{_dynamic_encryption_8cs_source_l00056}00056\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{byte}[]\ key3\ =\ \mbox{\hyperlink{struct_s_a_p_team_1_1_kryptor_1_1_key_store}{KeyStore}}[process.ChunkIndex\ +\ process.\mbox{\hyperlink{struct_s_a_p_team_1_1_kryptor_1_1_crypto_process_a595bacd26f1a8e2d678728bc9bfb30f6}{BlockSize}}];}
\DoxyCodeLine{\Hypertarget{_dynamic_encryption_8cs_source_l00057}00057\ }
\DoxyCodeLine{\Hypertarget{_dynamic_encryption_8cs_source_l00058}00058\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{byte}[]\ mKey\ =\ process.BlockIndex\ >\ 0}
\DoxyCodeLine{\Hypertarget{_dynamic_encryption_8cs_source_l00059}00059\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ?\ ((\textcolor{keywordtype}{byte}[])process.\mbox{\hyperlink{struct_s_a_p_team_1_1_kryptor_1_1_crypto_process_a79ae3d2618fcb6694b47fbcf31221f5d}{ProcessData}}[\$\textcolor{stringliteral}{"{}b\{process.BlockIndex\ -\/\ 1\}.sha512"{}}]).Concat(key1).Concat(key2).Concat(key3).Concat(process.\mbox{\hyperlink{struct_s_a_p_team_1_1_kryptor_1_1_crypto_process_a2adefff6d95c1aa4dca2a880a1403e49}{BlockHash}}).ToArray()}
\DoxyCodeLine{\Hypertarget{_dynamic_encryption_8cs_source_l00060}00060\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ :\ key1.Concat(key2).Concat(key3).Concat(process.\mbox{\hyperlink{struct_s_a_p_team_1_1_kryptor_1_1_crypto_process_a2adefff6d95c1aa4dca2a880a1403e49}{BlockHash}}).ToArray();}
\DoxyCodeLine{\Hypertarget{_dynamic_encryption_8cs_source_l00061}00061\ }
\DoxyCodeLine{\Hypertarget{_dynamic_encryption_8cs_source_l00062}00062\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ mKey.Sha256();}
\DoxyCodeLine{\Hypertarget{_dynamic_encryption_8cs_source_l00063}00063\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{_dynamic_encryption_8cs_source_l00064}00064\ }
\DoxyCodeLine{\Hypertarget{_dynamic_encryption_8cs_source_l00065}00065\ \ \ \ \ \ \ \ \ \textcolor{keyword}{internal}\ \textcolor{keyword}{static}\ \textcolor{keywordtype}{byte}[]\ CreateMixedIV(\mbox{\hyperlink{struct_s_a_p_team_1_1_kryptor_1_1_key_store}{KeyStore}}\ keyStore,\ \mbox{\hyperlink{struct_s_a_p_team_1_1_kryptor_1_1_crypto_process}{CryptoProcess}}\ process)}
\DoxyCodeLine{\Hypertarget{_dynamic_encryption_8cs_source_l00066}00066\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{_dynamic_encryption_8cs_source_l00067}00067\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ index\ =\ process.ChunkIndex\ +\ process.\mbox{\hyperlink{struct_s_a_p_team_1_1_kryptor_1_1_crypto_process_a1497fa24adbf3278698a14ab1ecd33df}{BlockIndex}};}
\DoxyCodeLine{\Hypertarget{_dynamic_encryption_8cs_source_l00068}00068\ }
\DoxyCodeLine{\Hypertarget{_dynamic_encryption_8cs_source_l00069}00069\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{new}\ \textcolor{keywordtype}{byte}[16]}
\DoxyCodeLine{\Hypertarget{_dynamic_encryption_8cs_source_l00070}00070\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{_dynamic_encryption_8cs_source_l00071}00071\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ keyStore[index\ *\ 6][4],}
\DoxyCodeLine{\Hypertarget{_dynamic_encryption_8cs_source_l00072}00072\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ keyStore[index\ *\ 2][12],}
\DoxyCodeLine{\Hypertarget{_dynamic_encryption_8cs_source_l00073}00073\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ keyStore[index\ -\/\ 154][7],}
\DoxyCodeLine{\Hypertarget{_dynamic_encryption_8cs_source_l00074}00074\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ keyStore[index\ +\ 53][19],}
\DoxyCodeLine{\Hypertarget{_dynamic_encryption_8cs_source_l00075}00075\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ keyStore[(index\ +\ 5)\ *\ 6][9],}
\DoxyCodeLine{\Hypertarget{_dynamic_encryption_8cs_source_l00076}00076\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ keyStore[index\ /\ 4][13],}
\DoxyCodeLine{\Hypertarget{_dynamic_encryption_8cs_source_l00077}00077\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ keyStore[index\ -\/\ 79][23],}
\DoxyCodeLine{\Hypertarget{_dynamic_encryption_8cs_source_l00078}00078\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ keyStore[index\ +\ 571][0],}
\DoxyCodeLine{\Hypertarget{_dynamic_encryption_8cs_source_l00079}00079\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ keyStore[index\ \%\ 3][21],}
\DoxyCodeLine{\Hypertarget{_dynamic_encryption_8cs_source_l00080}00080\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ keyStore[index\ +\ 1][16],}
\DoxyCodeLine{\Hypertarget{_dynamic_encryption_8cs_source_l00081}00081\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ keyStore[index\ -\/\ 98][13],}
\DoxyCodeLine{\Hypertarget{_dynamic_encryption_8cs_source_l00082}00082\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ keyStore[index\ +\ 65][23],}
\DoxyCodeLine{\Hypertarget{_dynamic_encryption_8cs_source_l00083}00083\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ keyStore[index\ -\/\ 61][8],}
\DoxyCodeLine{\Hypertarget{_dynamic_encryption_8cs_source_l00084}00084\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ keyStore[index\ +\ 34][2],}
\DoxyCodeLine{\Hypertarget{_dynamic_encryption_8cs_source_l00085}00085\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ keyStore[index\ +\ 79][9],}
\DoxyCodeLine{\Hypertarget{_dynamic_encryption_8cs_source_l00086}00086\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ keyStore[index\ -\/\ 172][6],}
\DoxyCodeLine{\Hypertarget{_dynamic_encryption_8cs_source_l00087}00087\ \ \ \ \ \ \ \ \ \ \ \ \ \};}
\DoxyCodeLine{\Hypertarget{_dynamic_encryption_8cs_source_l00088}00088\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{_dynamic_encryption_8cs_source_l00089}00089\ }
\DoxyCodeLine{\Hypertarget{_dynamic_encryption_8cs_source_l00090}00090\ \ \ \ \ \ \ \ \ \textcolor{keyword}{internal}\ \textcolor{keyword}{static}\ \textcolor{keywordtype}{int}\ GetDynamicBlockSize(\mbox{\hyperlink{struct_s_a_p_team_1_1_kryptor_1_1_key_store}{KeyStore}}\ keyStore,\ \mbox{\hyperlink{struct_s_a_p_team_1_1_kryptor_1_1_crypto_process}{CryptoProcess}}\ process)}
\DoxyCodeLine{\Hypertarget{_dynamic_encryption_8cs_source_l00091}00091\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{_dynamic_encryption_8cs_source_l00092}00092\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ index\ =\ process.\mbox{\hyperlink{struct_s_a_p_team_1_1_kryptor_1_1_crypto_process_a1497fa24adbf3278698a14ab1ecd33df}{BlockIndex}};}
\DoxyCodeLine{\Hypertarget{_dynamic_encryption_8cs_source_l00093}00093\ }
\DoxyCodeLine{\Hypertarget{_dynamic_encryption_8cs_source_l00094}00094\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{byte}[]\ lastBytes\ =\ keyStore.\mbox{\hyperlink{struct_s_a_p_team_1_1_kryptor_1_1_key_store_a43d431b918a4fc357132e26cd457f526}{Raw}}[(keyStore.Raw.Length\ -\/\ 5\ -\/\ index)..\string^(1\ +\ index)];}
\DoxyCodeLine{\Hypertarget{_dynamic_encryption_8cs_source_l00095}00095\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ Math.Abs(BitConverter.ToInt32(lastBytes,\ 0)\ \%\ 0xC000);}
\DoxyCodeLine{\Hypertarget{_dynamic_encryption_8cs_source_l00096}00096\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{_dynamic_encryption_8cs_source_l00097}00097\ }
\DoxyCodeLine{\Hypertarget{_dynamic_encryption_8cs_source_l00098}00098\ \ \ \ \ \ \ \ \ \textcolor{keyword}{internal}\ \textcolor{keyword}{static}\ \textcolor{keywordtype}{int}\ GetDynamicBlockEntropy(\mbox{\hyperlink{struct_s_a_p_team_1_1_kryptor_1_1_key_store}{KeyStore}}\ keyStore,\ \mbox{\hyperlink{struct_s_a_p_team_1_1_kryptor_1_1_crypto_process}{CryptoProcess}}\ process)}
\DoxyCodeLine{\Hypertarget{_dynamic_encryption_8cs_source_l00099}00099\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{_dynamic_encryption_8cs_source_l00100}00100\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ index\ =\ process.BlockIndex\ *\ 4;}
\DoxyCodeLine{\Hypertarget{_dynamic_encryption_8cs_source_l00101}00101\ }
\DoxyCodeLine{\Hypertarget{_dynamic_encryption_8cs_source_l00102}00102\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{byte}[]\ lastBytes\ =\ keyStore.\mbox{\hyperlink{struct_s_a_p_team_1_1_kryptor_1_1_key_store_a43d431b918a4fc357132e26cd457f526}{Raw}}[index..(index\ +\ 5)];}
\DoxyCodeLine{\Hypertarget{_dynamic_encryption_8cs_source_l00103}00103\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ BitConverter.ToInt32(lastBytes,\ 0)\ \%\ 0xC000;}
\DoxyCodeLine{\Hypertarget{_dynamic_encryption_8cs_source_l00104}00104\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{_dynamic_encryption_8cs_source_l00105}00105\ }
\DoxyCodeLine{\Hypertarget{_dynamic_encryption_8cs_source_l00106}00106\ \ \ \ \ \ \ \ \ \textcolor{keyword}{internal}\ \textcolor{keyword}{static}\ \textcolor{keywordtype}{int}\ GetDynamicChunkEntropy(\mbox{\hyperlink{struct_s_a_p_team_1_1_kryptor_1_1_key_store}{KeyStore}}\ keyStore,\ \mbox{\hyperlink{struct_s_a_p_team_1_1_kryptor_1_1_crypto_process}{CryptoProcess}}\ process)}
\DoxyCodeLine{\Hypertarget{_dynamic_encryption_8cs_source_l00107}00107\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{_dynamic_encryption_8cs_source_l00108}00108\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ index\ =\ process.BlockIndex\ +\ process.\mbox{\hyperlink{struct_s_a_p_team_1_1_kryptor_1_1_crypto_process_a84625de43ef2ce2991f9d20c084c3515}{ChunkIndex}};}
\DoxyCodeLine{\Hypertarget{_dynamic_encryption_8cs_source_l00109}00109\ }
\DoxyCodeLine{\Hypertarget{_dynamic_encryption_8cs_source_l00110}00110\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{byte}[]\ lastBytes\ =\ keyStore.\mbox{\hyperlink{struct_s_a_p_team_1_1_kryptor_1_1_key_store_a43d431b918a4fc357132e26cd457f526}{Raw}}[index..(index\ +\ 5)];}
\DoxyCodeLine{\Hypertarget{_dynamic_encryption_8cs_source_l00111}00111\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ BitConverter.ToInt32(lastBytes,\ 0)\ \%\ 0xC000;}
\DoxyCodeLine{\Hypertarget{_dynamic_encryption_8cs_source_l00112}00112\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{_dynamic_encryption_8cs_source_l00113}00113\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{_dynamic_encryption_8cs_source_l00114}00114\ \}}

\end{DoxyCode}
