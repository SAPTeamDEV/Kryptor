\doxysection{Key\+Store.\+cs}
\hypertarget{_key_store_8cs_source}{}\label{_key_store_8cs_source}\index{KeyStore.cs@{KeyStore.cs}}
\mbox{\hyperlink{_key_store_8cs}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{_key_store_8cs_source_l00001}00001\ \textcolor{keyword}{using\ }\mbox{\hyperlink{namespace_s_a_p_team_1_1_kryptor_1_1_extensions}{SAPTeam.Kryptor.Extensions}};}
\DoxyCodeLine{\Hypertarget{_key_store_8cs_source_l00002}00002\ \textcolor{keyword}{using\ }\mbox{\hyperlink{namespace_s_a_p_team_1_1_kryptor_1_1_generators}{SAPTeam.Kryptor.Generators}};}
\DoxyCodeLine{\Hypertarget{_key_store_8cs_source_l00003}00003\ }
\DoxyCodeLine{\Hypertarget{_key_store_8cs_source_l00004}00004\ \textcolor{keyword}{namespace\ }\mbox{\hyperlink{namespace_s_a_p_team_1_1_kryptor}{SAPTeam.Kryptor}}}
\DoxyCodeLine{\Hypertarget{_key_store_8cs_source_l00005}00005\ \{}
\DoxyCodeLine{\Hypertarget{_key_store_8cs_source_l00009}\mbox{\hyperlink{struct_s_a_p_team_1_1_kryptor_1_1_key_store}{00009}}\ \ \ \ \ \textcolor{keyword}{public}\ readonly\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_s_a_p_team_1_1_kryptor_1_1_key_store}{KeyStore}}}
\DoxyCodeLine{\Hypertarget{_key_store_8cs_source_l00010}00010\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{_key_store_8cs_source_l00011}00011\ \ \ \ \ \ \ \ \ \textcolor{keyword}{private}\ \textcolor{keyword}{static}\ readonly\ \mbox{\hyperlink{class_s_a_p_team_1_1_kryptor_1_1_generators_1_1_crypto_random}{CryptoRandom}}\ random\ =\ \textcolor{keyword}{new}\ \mbox{\hyperlink{class_s_a_p_team_1_1_kryptor_1_1_generators_1_1_crypto_random}{CryptoRandom}}();}
\DoxyCodeLine{\Hypertarget{_key_store_8cs_source_l00012}00012\ }
\DoxyCodeLine{\Hypertarget{_key_store_8cs_source_l00022}\mbox{\hyperlink{struct_s_a_p_team_1_1_kryptor_1_1_key_store_af8773ff2ee5b39b7600d64ab2a7e15fc}{00022}}\ \ \ \ \ \ \ \ \ \textcolor{keyword}{public}\ \textcolor{keywordtype}{byte}[]\ \textcolor{keyword}{this}[\textcolor{keywordtype}{int}\ index]\ =>\ \mbox{\hyperlink{struct_s_a_p_team_1_1_kryptor_1_1_key_store_a915c2bc45850f49ff277bebc78f5642a}{Keys}}[Math.Abs(index)\ \%\ \mbox{\hyperlink{struct_s_a_p_team_1_1_kryptor_1_1_key_store_a915c2bc45850f49ff277bebc78f5642a}{Keys}}.Length];}
\DoxyCodeLine{\Hypertarget{_key_store_8cs_source_l00023}00023\ }
\DoxyCodeLine{\Hypertarget{_key_store_8cs_source_l00027}\mbox{\hyperlink{struct_s_a_p_team_1_1_kryptor_1_1_key_store_a915c2bc45850f49ff277bebc78f5642a}{00027}}\ \ \ \ \ \ \ \ \ \textcolor{keyword}{public}\ \textcolor{keywordtype}{byte}[][]\ \mbox{\hyperlink{struct_s_a_p_team_1_1_kryptor_1_1_key_store_a915c2bc45850f49ff277bebc78f5642a}{Keys}}\ \{\ \textcolor{keyword}{get};\ \}}
\DoxyCodeLine{\Hypertarget{_key_store_8cs_source_l00028}00028\ }
\DoxyCodeLine{\Hypertarget{_key_store_8cs_source_l00032}\mbox{\hyperlink{struct_s_a_p_team_1_1_kryptor_1_1_key_store_a43d431b918a4fc357132e26cd457f526}{00032}}\ \ \ \ \ \ \ \ \ \textcolor{keyword}{public}\ \textcolor{keywordtype}{byte}[]\ \mbox{\hyperlink{struct_s_a_p_team_1_1_kryptor_1_1_key_store_a43d431b918a4fc357132e26cd457f526}{Raw}}\ \{\ \textcolor{keyword}{get};\ \}}
\DoxyCodeLine{\Hypertarget{_key_store_8cs_source_l00033}00033\ }
\DoxyCodeLine{\Hypertarget{_key_store_8cs_source_l00037}\mbox{\hyperlink{struct_s_a_p_team_1_1_kryptor_1_1_key_store_a13eeddb6bcec7c0663c13ea9502a4472}{00037}}\ \ \ \ \ \ \ \ \ \textcolor{keyword}{public}\ \textcolor{keywordtype}{byte}[]\ \mbox{\hyperlink{struct_s_a_p_team_1_1_kryptor_1_1_key_store_a13eeddb6bcec7c0663c13ea9502a4472}{Fingerprint}}\ \{\ \textcolor{keyword}{get};\ \}}
\DoxyCodeLine{\Hypertarget{_key_store_8cs_source_l00038}00038\ }
\DoxyCodeLine{\Hypertarget{_key_store_8cs_source_l00045}\mbox{\hyperlink{struct_s_a_p_team_1_1_kryptor_1_1_key_store_a6795fdb6044d93d673fcdcbe401aefe7}{00045}}\ \ \ \ \ \ \ \ \ \textcolor{keyword}{public}\ \mbox{\hyperlink{struct_s_a_p_team_1_1_kryptor_1_1_key_store_a6795fdb6044d93d673fcdcbe401aefe7}{KeyStore}}(\textcolor{keywordtype}{byte}[]\ bytes)}
\DoxyCodeLine{\Hypertarget{_key_store_8cs_source_l00046}00046\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{_key_store_8cs_source_l00047}00047\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (bytes\ ==\ \textcolor{keyword}{null})\ \textcolor{keywordflow}{throw}\ \textcolor{keyword}{new}\ ArgumentNullException(nameof(bytes));}
\DoxyCodeLine{\Hypertarget{_key_store_8cs_source_l00048}00048\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (bytes.Length\ ==\ 0)\ \textcolor{keywordflow}{throw}\ \textcolor{keyword}{new}\ ArgumentException(\$\textcolor{stringliteral}{"{}The\ keys\ array\ is\ empty"{}});}
\DoxyCodeLine{\Hypertarget{_key_store_8cs_source_l00049}00049\ }
\DoxyCodeLine{\Hypertarget{_key_store_8cs_source_l00050}00050\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{struct_s_a_p_team_1_1_kryptor_1_1_key_store_a43d431b918a4fc357132e26cd457f526}{Raw}}\ =\ bytes;}
\DoxyCodeLine{\Hypertarget{_key_store_8cs_source_l00051}00051\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{struct_s_a_p_team_1_1_kryptor_1_1_key_store_a915c2bc45850f49ff277bebc78f5642a}{Keys}}\ =\ \mbox{\hyperlink{struct_s_a_p_team_1_1_kryptor_1_1_key_store_a43d431b918a4fc357132e26cd457f526}{Raw}}.Chunk(32).Where(x\ =>\ x.Length\ ==\ 32).ToArray();}
\DoxyCodeLine{\Hypertarget{_key_store_8cs_source_l00052}00052\ }
\DoxyCodeLine{\Hypertarget{_key_store_8cs_source_l00053}00053\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{struct_s_a_p_team_1_1_kryptor_1_1_key_store_a13eeddb6bcec7c0663c13ea9502a4472}{Fingerprint}}\ =\ Transformers.Pick(\mbox{\hyperlink{struct_s_a_p_team_1_1_kryptor_1_1_key_store_a43d431b918a4fc357132e26cd457f526}{Raw}}.Sha512(),\ 12,\ \mbox{\hyperlink{struct_s_a_p_team_1_1_kryptor_1_1_key_store_a43d431b918a4fc357132e26cd457f526}{Raw}}.Length\ +\ \mbox{\hyperlink{struct_s_a_p_team_1_1_kryptor_1_1_key_store_a43d431b918a4fc357132e26cd457f526}{Raw}}[4]\ +\ \mbox{\hyperlink{struct_s_a_p_team_1_1_kryptor_1_1_key_store_a43d431b918a4fc357132e26cd457f526}{Raw}}[\mbox{\hyperlink{struct_s_a_p_team_1_1_kryptor_1_1_key_store_a43d431b918a4fc357132e26cd457f526}{Raw}}.Length\ -\/\ 5]\ +\ \mbox{\hyperlink{struct_s_a_p_team_1_1_kryptor_1_1_key_store_a43d431b918a4fc357132e26cd457f526}{Raw}}.Length\ +\ \mbox{\hyperlink{struct_s_a_p_team_1_1_kryptor_1_1_key_store_a43d431b918a4fc357132e26cd457f526}{Raw}}[14]\ +\ \mbox{\hyperlink{struct_s_a_p_team_1_1_kryptor_1_1_key_store_a43d431b918a4fc357132e26cd457f526}{Raw}}[\mbox{\hyperlink{struct_s_a_p_team_1_1_kryptor_1_1_key_store_a43d431b918a4fc357132e26cd457f526}{Raw}}.Length\ -\/\ 10]).ToArray().Sha256().Take(20).ToArray();}
\DoxyCodeLine{\Hypertarget{_key_store_8cs_source_l00054}00054\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{_key_store_8cs_source_l00055}00055\ }
\DoxyCodeLine{\Hypertarget{_key_store_8cs_source_l00065}00065\ \ \ \ \ \ \ \ \ [Obsolete(\textcolor{stringliteral}{"{}Use\ IGenerator\ classes\ such\ as\ CryptoRandom\ or\ UnixRandom"{}})]}
\DoxyCodeLine{\Hypertarget{_key_store_8cs_source_l00066}\mbox{\hyperlink{struct_s_a_p_team_1_1_kryptor_1_1_key_store_a721f80494c9a4b561d8ed67571f40106}{00066}}\ \ \ \ \ \ \ \ \ \textcolor{keyword}{public}\ \textcolor{keyword}{static}\ \mbox{\hyperlink{struct_s_a_p_team_1_1_kryptor_1_1_key_store}{KeyStore}}\ \mbox{\hyperlink{struct_s_a_p_team_1_1_kryptor_1_1_key_store_a721f80494c9a4b561d8ed67571f40106}{Generate}}(\textcolor{keywordtype}{int}\ count\ =\ 0)}
\DoxyCodeLine{\Hypertarget{_key_store_8cs_source_l00067}00067\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{_key_store_8cs_source_l00068}00068\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (count\ <=\ 0)}
\DoxyCodeLine{\Hypertarget{_key_store_8cs_source_l00069}00069\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{_key_store_8cs_source_l00070}00070\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ count\ =\ \mbox{\hyperlink{struct_s_a_p_team_1_1_kryptor_1_1_key_store_a3e23aac39eed57dfd250a98d1e56d4a2}{GetRandomOddNumber}}();}
\DoxyCodeLine{\Hypertarget{_key_store_8cs_source_l00071}00071\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{_key_store_8cs_source_l00072}00072\ }
\DoxyCodeLine{\Hypertarget{_key_store_8cs_source_l00073}00073\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{byte}[]\ result\ =\ \textcolor{keyword}{new}\ \textcolor{keywordtype}{byte}[count\ *\ 32];}
\DoxyCodeLine{\Hypertarget{_key_store_8cs_source_l00074}00074\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{new}\ \mbox{\hyperlink{class_s_a_p_team_1_1_kryptor_1_1_generators_1_1_safe_rng}{SafeRng}}().\mbox{\hyperlink{class_s_a_p_team_1_1_kryptor_1_1_generators_1_1_safe_rng_aa709f7694d98ce955709086f9e8a7d2d}{Generate}}(result);}
\DoxyCodeLine{\Hypertarget{_key_store_8cs_source_l00075}00075\ }
\DoxyCodeLine{\Hypertarget{_key_store_8cs_source_l00076}00076\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{new}\ \mbox{\hyperlink{struct_s_a_p_team_1_1_kryptor_1_1_key_store_a6795fdb6044d93d673fcdcbe401aefe7}{KeyStore}}(result);}
\DoxyCodeLine{\Hypertarget{_key_store_8cs_source_l00077}00077\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{_key_store_8cs_source_l00078}00078\ }
\DoxyCodeLine{\Hypertarget{_key_store_8cs_source_l00083}\mbox{\hyperlink{struct_s_a_p_team_1_1_kryptor_1_1_key_store_a3e23aac39eed57dfd250a98d1e56d4a2}{00083}}\ \ \ \ \ \ \ \ \ \textcolor{keyword}{public}\ \textcolor{keyword}{static}\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{struct_s_a_p_team_1_1_kryptor_1_1_key_store_a3e23aac39eed57dfd250a98d1e56d4a2}{GetRandomOddNumber}}()}
\DoxyCodeLine{\Hypertarget{_key_store_8cs_source_l00084}00084\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{_key_store_8cs_source_l00085}00085\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ count\ =\ random.Next(257,\ 2047);}
\DoxyCodeLine{\Hypertarget{_key_store_8cs_source_l00086}00086\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (count\ \%\ 2\ ==\ 0)}
\DoxyCodeLine{\Hypertarget{_key_store_8cs_source_l00087}00087\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{_key_store_8cs_source_l00088}00088\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ count++;}
\DoxyCodeLine{\Hypertarget{_key_store_8cs_source_l00089}00089\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{_key_store_8cs_source_l00090}00090\ }
\DoxyCodeLine{\Hypertarget{_key_store_8cs_source_l00091}00091\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ count;}
\DoxyCodeLine{\Hypertarget{_key_store_8cs_source_l00092}00092\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{_key_store_8cs_source_l00093}00093\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{_key_store_8cs_source_l00094}00094\ \}}

\end{DoxyCode}
